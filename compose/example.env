# AI Video Analytics System Configuration
# Comments explain how each variable impacts behavior/performance.

# Docker Compose project name (used for container naming).
COMPOSE_PROJECT_NAME=ai-video-analytics

# Image version tag used by compose to select the local image.
AVAS_VERSION=v0.1.0

# Detection Model (YOLO family name). Used to resolve model files.
DETECTION_MODEL=yolo26x

# System Configuration
LOG_LEVEL=INFO
# Grant container access to host webcams (/dev/video*). Uses privileged mode.
# Set True to enable webcam access; keep False for tighter security.
GRANT_WEBCAM_ACCESS=True

# Pose Detection Toggle
# Enable pose detection alongside person detection when True.
POSE_DETECTION=True
# Pose model name or explicit .pt/.onnx/.engine path used when POSE_DETECTION=True.
POSE_DETECTION_MODEL=yolo26x-pose

# Tracking Toggle
# Enable object tracking (custom ByteTrack/BoT-SORT/DeepSORT) on sequential frames.
ENABLE_TRACKING=True
# Tracker type: bytetrack | botsort | deepsort
TRACKER_TYPE=botsort
# Optional ReID model for DeepSORT/BoT-SORT appearance features.
# Set a model name (e.g. osnet_x0_25) to auto-download/export based on INFERENCE_BACKEND.
# You may also provide an explicit .onnx/.engine path. Leave empty to use lightweight color-hist features instead.
TRACKER_REID_MODEL=osnet_x0_25
# ReID embedding batch size (larger batches improve throughput, increase VRAM).
TRACKER_REID_BATCH_SIZE=32
# ReID device override (e.g. cuda:0, cpu). Leave empty for auto.
TRACKER_REID_DEVICE=cuda:0
# Tracker matching strategy: greedy (fast, approximate) or hungarian (slower, optimal).
# Use hungarian for higher accuracy in crowded scenes at the cost of CPU time.
TRACKER_MATCHING=hungarian

# Batch Processing Configuration
# Max batch size used by the detector. Higher batch sizes improve throughput but
# increase latency and GPU memory usage.
DET_BATCH_SIZE=8
# Max batch size used by the pose model. Defaults to DET_BATCH_SIZE if unset.
POSE_BATCH_SIZE=8

# Default Request Parameters
# Confidence threshold used when a request does not specify one. Higher means
# fewer detections (faster postproc, potentially lower recall).
DEF_DET_THRESH=0.7
# When true, include cropped person data in the response (more CPU work, larger payloads).
DEF_RETURN_PERSON_DATA=False
# Headers used when fetching images by URL.
DEF_IMG_REQ_HEADERS='{"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0"}'

# Performance Settings
# Base model input size (WxH). Larger sizes improve accuracy but cost more GPU time.
MAX_SIZE=640,640
# Inference backend (global): trt / onnx / ultralytics / openvino.
# Applies to detection + pose models (and ReID export when tracking is enabled).
INFERENCE_BACKEND=trt
# TRT implementation: custom (this repo) or ultralytics (Ultralytics runtime).
TRT_IMPLEMENTATION=custom
# Request FP16 precision (global). Engine must be built with FP16 support.
FORCE_FP16=True
# Gunicorn worker count. More workers can increase throughput but also memory use.
NUM_WORKERS=1

# Use nvJPEG for faster JPEG decoding on GPU if available.
USE_NVJPEG=True
# Run post-processing on GPU (CuPy NMS). Helps when many detections; can be slower for small batches.
# Aliases: USE_CUPY_NMS, CUPY_NMS
GPU_POSTPROC=True
# Use OpenCV CUDA preproc (resize/letterbox) + GPU normalization.
# Applies to TRT and ONNX (when CUDA providers are available). Alias: TRT_GPU_PREPROC
GPU_PREPROC=True
# Use Numba JIT for YOLO decode and tracker matching hot paths.
# Alias: TRT_NUMBA_DECODE
NUMBA_DECODE=True
# Ultralytics TRT export: request fused NMS inside the engine (only for ultralytics TRT).
TRT_ULTRALYTICS_NMS=False
# Disable letterbox padding and resize directly to the input (stretches aspect ratio).
# Faster but can affect accuracy on non-square inputs.
TRT_NO_LETTERBOX=False
# Report GPU-side timings using CUDA events in the API output (tiny overhead).
TRT_GPU_TIMING=False

# Storage Paths
ROOT_IMAGES_DIR=/images
MODELS_DIR=/models

# Advanced
#DEBUG_LOG_RAW_OUTPUT=True
#DEBUG_LOG_RAW_ROWS=3
#DEBUG_LOG_RAW_COLS=8
